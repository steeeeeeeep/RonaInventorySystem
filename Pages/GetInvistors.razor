@page "/invistors"
@layout MainLayout

@inject BikeSparesInventorySystem.Data.Repositories.Repository<Invistor> InvistorRepository
@inject BikeSparesInventorySystem.Data.Services.AuthService AuthService;

<MudTable
    Items="@Elements" 
    FixedHeader="@Fixed_header" 
    FixedFooter="@Fixed_footer"
    Height="@(Fixed_header || Fixed_footer ? "calc(100vh - 64px - 64px - 64px)" : "")"
    Dense="@Dense"
    Hover="@Hover"
    ReadOnly="@ReadOnly"
    CanCancelEdit="@CanCancelEdit">

    <ToolBarContent>
        @if (AuthService.IsUserAdmin())
        {
            <MudFab class="me-4" StartIcon="@Icons.Material.Filled.Add"
                    Color="Color.Primary"
                    Label="Add Product"
                    DisableElevation="true"
                    OnClick="AddDialog" />
            <MudStack Row="true">
                <ImportButton T="Spare" ChangeParentState="StateHasChanged" />
                <ExportButton T="Spare" />
            </MudStack>
        }
        <MudSpacer />
        <MudTextField @bind-Value="SearchString" Placeholder="Search" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0" Clearable="true"></MudTextField>
    </ToolBarContent>
    <ColGroup>
        <col />
        <col />
        <col width="400" />
        <col />
        <col />
        <col/>
        <col/>
    </ColGroup>
    <HeaderContent>
        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Invistor, object>(x=>x.FirstName)">First Name</MudTableSortLabel></MudTh>
        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Invistor, object>(x=>x.LastName)">Last Name</MudTableSortLabel></MudTh>
        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Invistor, object>(x=>x.Description)">Description</MudTableSortLabel></MudTh>
        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Invistor, object>(x=>x.Amount)">Amount</MudTableSortLabel></MudTh>
        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Invistor, object>(x=>x.Percent)">Percent</MudTableSortLabel></MudTh>
        <MudTh Style="white-space: nowrap;" />
    </HeaderContent>
    <RowTemplate>
        <MudTd Style="white-space: nowrap;" DataLabel="First Name">@context.FirstName</MudTd> 
        <MudTd Style="white-space: nowrap;" DataLabel="Last Name">@context.LastName</MudTd> 
        <MudTd Style="white-space: nowrap;" DataLabel="Description">@context.Description</MudTd> 
        <MudTd Style="white-space: nowrap;" DataLabel="Amount">@context.Amount</MudTd> 
        <MudTd Style="white-space: nowrap;" DataLabel="Percent">@context.Percent</MudTd> 
    </RowTemplate>
    <RowEditingTemplate>
        <MudTd Style="white-space: nowrap;" DataLabel="First Name">
            <MudTextField @bind-Value="@context.FirstName" />
        </MudTd>
        <MudTd Style="white-space: nowrap;" DataLabel="Last Name">
            <MudTextField @bind-Value="@context.LastName" />
        </MudTd>
        <MudTd Style="white-space: nowrap;" DataLabel="Description">
            <MudTextField @bind-Value="@context.Description" />
        </MudTd>
        <MudTd Style="white-space: nowrap;" DataLabel="Amount" >
            <MudTextField @bind-Value="@context.Amount" />
        </MudTd>
        <MudTd Style="white-space: nowrap;" DataLabel="Percent">
            <MudTextField @bind-Value="@context.Percent" />
        </MudTd>
    </RowEditingTemplate>
</MudTable>